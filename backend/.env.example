# App Configuration
APP_NAME=ModernAuth
PORT=8080
APP_ENV=development
APP_BASE_URL=http://localhost:3000
# CORS Origins (comma-separated, use * for development to allow all)
# Example for production: CORS_ORIGINS=https://app.example.com,https://admin.example.com
CORS_ORIGINS=*

# Database Configuration
# format: postgres://user:password@localhost:5432/dbname?sslmode=disable
DATABASE_URL=postgres://modernauth:modernauth@localhost:5432/modernauth?sslmode=disable

# Redis Configuration
REDIS_URL=redis://localhost:6379

# Auth Configuration
# Generate a secret: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-minimum-32-chars-long-for-production
JWT_ISSUER=modernauth
ACCESS_TOKEN_TTL=15m
REFRESH_TOKEN_TTL=168h
SESSION_TTL=168h

# Account Lockout Configuration
LOCKOUT_MAX_ATTEMPTS=5
LOCKOUT_WINDOW=15m
LOCKOUT_DURATION=30m

# Email Configuration
# Provider: console (logs to console), smtp (SMTP server), or sendgrid (SendGrid API)
EMAIL_PROVIDER=console
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
EMAIL_FROM=noreply@modernauth.local
EMAIL_FROM_NAME=ModernAuth

# SendGrid Configuration (if EMAIL_PROVIDER=sendgrid)
SENDGRID_API_KEY=

# Email Queue Configuration
# Enable async queue with retry logic for email delivery
EMAIL_QUEUE_ENABLED=true
EMAIL_QUEUE_SIZE=1000

# Email Rate Limiting
# Limits per user per hour to prevent abuse
EMAIL_RATE_LIMIT_ENABLED=true
EMAIL_VERIFICATION_RATE_LIMIT=3
EMAIL_PASSWORD_RESET_RATE_LIMIT=5

# OAuth2 Configuration (optional)
# Google OAuth - https://console.cloud.google.com/apis/credentials
OAUTH_GOOGLE_CLIENT_ID=
OAUTH_GOOGLE_CLIENT_SECRET=

# GitHub OAuth - https://github.com/settings/developers
OAUTH_GITHUB_CLIENT_ID=
OAUTH_GITHUB_CLIENT_SECRET=

# Microsoft OAuth - https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps
OAUTH_MICROSOFT_CLIENT_ID=
OAUTH_MICROSOFT_CLIENT_SECRET=

# Apple OAuth - https://developer.apple.com/account/resources/identifiers
OAUTH_APPLE_CLIENT_ID=
OAUTH_APPLE_CLIENT_SECRET=
OAUTH_APPLE_TEAM_ID=
OAUTH_APPLE_KEY_ID=

# Facebook OAuth - https://developers.facebook.com/apps
OAUTH_FACEBOOK_CLIENT_ID=
OAUTH_FACEBOOK_CLIENT_SECRET=

# LinkedIn OAuth - https://www.linkedin.com/developers/apps
OAUTH_LINKEDIN_CLIENT_ID=
OAUTH_LINKEDIN_CLIENT_SECRET=

# Discord OAuth - https://discord.com/developers/applications
OAUTH_DISCORD_CLIENT_ID=
OAUTH_DISCORD_CLIENT_SECRET=

# Twitter/X OAuth - https://developer.twitter.com/en/portal/dashboard
OAUTH_TWITTER_CLIENT_ID=
OAUTH_TWITTER_CLIENT_SECRET=

# GitLab OAuth - https://gitlab.com/-/profile/applications
OAUTH_GITLAB_CLIENT_ID=
OAUTH_GITLAB_CLIENT_SECRET=

# Slack OAuth - https://api.slack.com/apps
OAUTH_SLACK_CLIENT_ID=
OAUTH_SLACK_CLIENT_SECRET=

# Spotify OAuth - https://developer.spotify.com/dashboard
OAUTH_SPOTIFY_CLIENT_ID=
OAUTH_SPOTIFY_CLIENT_SECRET=

# OAuth redirect base URL (defaults to APP_BASE_URL)
OAUTH_REDIRECT_BASE_URL=

# CAPTCHA / Bot Detection Configuration
# Provider: none (disabled), recaptcha_v2, recaptcha_v3, or turnstile
CAPTCHA_PROVIDER=none
# Site key (public, sent to frontend)
CAPTCHA_SITE_KEY=
# Secret key (server-side verification)
CAPTCHA_SECRET_KEY=
# Minimum score for reCAPTCHA v3 (0.0-1.0, default 0.5)
CAPTCHA_MIN_SCORE=0.5

# Breached Password Detection (HaveIBeenPwned)
# Uses k-Anonymity model - only a 5-char hash prefix is sent to the API
HIBP_ENABLED=false
HIBP_API_KEY=
HIBP_CACHE_TTL=24h

# SMS Configuration (for SMS MFA)
# Provider: console (logs to stdout) or twilio
SMS_PROVIDER=console
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=
